{"ast":null,"code":"import throttle from 'lodash.throttle';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { ChannelPreviewMessenger } from './ChannelPreviewMessenger';\nimport { useIsChannelMuted } from './hooks/useIsChannelMuted';\nimport { useChannelPreviewInfo } from './hooks/useChannelPreviewInfo';\nimport { getLatestMessagePreview as defaultGetLatestMessagePreview } from './utils';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { useMessageDeliveryStatus } from './hooks/useMessageDeliveryStatus';\nexport const ChannelPreview = props => {\n  const {\n    channel,\n    Preview = ChannelPreviewMessenger,\n    channelUpdateCount,\n    getLatestMessagePreview = defaultGetLatestMessagePreview\n  } = props;\n  const {\n    channel: activeChannel,\n    client,\n    setActiveChannel\n  } = useChatContext('ChannelPreview');\n  const {\n    t,\n    userLanguage\n  } = useTranslationContext('ChannelPreview');\n  const {\n    displayImage,\n    displayTitle,\n    groupChannelDisplayInfo\n  } = useChannelPreviewInfo({\n    channel\n  });\n  const [lastMessage, setLastMessage] = useState(channel.state.messages[channel.state.messages.length - 1]);\n  const [unread, setUnread] = useState(0);\n  const {\n    messageDeliveryStatus\n  } = useMessageDeliveryStatus({\n    channel,\n    lastMessage\n  });\n  const isActive = activeChannel?.cid === channel.cid;\n  const {\n    muted\n  } = useIsChannelMuted(channel);\n  useEffect(() => {\n    const handleEvent = event => {\n      if (!event.cid) return setUnread(0);\n      if (channel.cid === event.cid) setUnread(0);\n    };\n    client.on('notification.mark_read', handleEvent);\n    return () => client.off('notification.mark_read', handleEvent);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(() => {\n    const handleEvent = event => {\n      if (channel.cid !== event.cid) return;\n      if (event.user?.id !== client.user?.id) return;\n      setUnread(channel.countUnread());\n    };\n    channel.on('notification.mark_unread', handleEvent);\n    return () => {\n      channel.off('notification.mark_unread', handleEvent);\n    };\n  }, [channel, client]);\n  const refreshUnreadCount = useMemo(() => throttle(() => {\n    if (muted) {\n      setUnread(0);\n    } else {\n      setUnread(channel.countUnread());\n    }\n  }, 400), [channel, muted]);\n  useEffect(() => {\n    refreshUnreadCount();\n    const handleEvent = () => {\n      setLastMessage(channel.state.latestMessages[channel.state.latestMessages.length - 1]);\n      refreshUnreadCount();\n    };\n    channel.on('message.new', handleEvent);\n    channel.on('message.updated', handleEvent);\n    channel.on('message.deleted', handleEvent);\n    channel.on('message.undeleted', handleEvent);\n    channel.on('channel.truncated', handleEvent);\n    return () => {\n      channel.off('message.new', handleEvent);\n      channel.off('message.updated', handleEvent);\n      channel.off('message.deleted', handleEvent);\n      channel.off('message.undeleted', handleEvent);\n      channel.off('channel.truncated', handleEvent);\n    };\n  }, [channel, refreshUnreadCount, channelUpdateCount]);\n  if (!Preview) return null;\n  const latestMessagePreview = getLatestMessagePreview(channel, t, userLanguage);\n  return React.createElement(Preview, {\n    ...props,\n    active: isActive,\n    displayImage: displayImage,\n    displayTitle: displayTitle,\n    groupChannelDisplayInfo: groupChannelDisplayInfo,\n    lastMessage: lastMessage,\n    latestMessage: latestMessagePreview,\n    latestMessagePreview: latestMessagePreview,\n    messageDeliveryStatus: messageDeliveryStatus,\n    setActiveChannel: setActiveChannel,\n    unread: unread\n  });\n};","map":{"version":3,"names":["throttle","React","useEffect","useMemo","useState","ChannelPreviewMessenger","useIsChannelMuted","useChannelPreviewInfo","getLatestMessagePreview","defaultGetLatestMessagePreview","useChatContext","useTranslationContext","useMessageDeliveryStatus","ChannelPreview","props","channel","Preview","channelUpdateCount","activeChannel","client","setActiveChannel","t","userLanguage","displayImage","displayTitle","groupChannelDisplayInfo","lastMessage","setLastMessage","state","messages","length","unread","setUnread","messageDeliveryStatus","isActive","cid","muted","handleEvent","event","on","off","user","id","countUnread","refreshUnreadCount","latestMessages","latestMessagePreview","createElement","active","latestMessage"],"sources":["C:/Users/abdel/OneDrive/Desktop/Medical-plager/client/node_modules/stream-chat-react/dist/components/ChannelPreview/ChannelPreview.js"],"sourcesContent":["import throttle from 'lodash.throttle';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { ChannelPreviewMessenger } from './ChannelPreviewMessenger';\nimport { useIsChannelMuted } from './hooks/useIsChannelMuted';\nimport { useChannelPreviewInfo } from './hooks/useChannelPreviewInfo';\nimport { getLatestMessagePreview as defaultGetLatestMessagePreview } from './utils';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { useMessageDeliveryStatus } from './hooks/useMessageDeliveryStatus';\nexport const ChannelPreview = (props) => {\n    const { channel, Preview = ChannelPreviewMessenger, channelUpdateCount, getLatestMessagePreview = defaultGetLatestMessagePreview, } = props;\n    const { channel: activeChannel, client, setActiveChannel } = useChatContext('ChannelPreview');\n    const { t, userLanguage } = useTranslationContext('ChannelPreview');\n    const { displayImage, displayTitle, groupChannelDisplayInfo } = useChannelPreviewInfo({\n        channel,\n    });\n    const [lastMessage, setLastMessage] = useState(channel.state.messages[channel.state.messages.length - 1]);\n    const [unread, setUnread] = useState(0);\n    const { messageDeliveryStatus } = useMessageDeliveryStatus({\n        channel,\n        lastMessage,\n    });\n    const isActive = activeChannel?.cid === channel.cid;\n    const { muted } = useIsChannelMuted(channel);\n    useEffect(() => {\n        const handleEvent = (event) => {\n            if (!event.cid)\n                return setUnread(0);\n            if (channel.cid === event.cid)\n                setUnread(0);\n        };\n        client.on('notification.mark_read', handleEvent);\n        return () => client.off('notification.mark_read', handleEvent);\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n    useEffect(() => {\n        const handleEvent = (event) => {\n            if (channel.cid !== event.cid)\n                return;\n            if (event.user?.id !== client.user?.id)\n                return;\n            setUnread(channel.countUnread());\n        };\n        channel.on('notification.mark_unread', handleEvent);\n        return () => {\n            channel.off('notification.mark_unread', handleEvent);\n        };\n    }, [channel, client]);\n    const refreshUnreadCount = useMemo(() => throttle(() => {\n        if (muted) {\n            setUnread(0);\n        }\n        else {\n            setUnread(channel.countUnread());\n        }\n    }, 400), [channel, muted]);\n    useEffect(() => {\n        refreshUnreadCount();\n        const handleEvent = () => {\n            setLastMessage(channel.state.latestMessages[channel.state.latestMessages.length - 1]);\n            refreshUnreadCount();\n        };\n        channel.on('message.new', handleEvent);\n        channel.on('message.updated', handleEvent);\n        channel.on('message.deleted', handleEvent);\n        channel.on('message.undeleted', handleEvent);\n        channel.on('channel.truncated', handleEvent);\n        return () => {\n            channel.off('message.new', handleEvent);\n            channel.off('message.updated', handleEvent);\n            channel.off('message.deleted', handleEvent);\n            channel.off('message.undeleted', handleEvent);\n            channel.off('channel.truncated', handleEvent);\n        };\n    }, [channel, refreshUnreadCount, channelUpdateCount]);\n    if (!Preview)\n        return null;\n    const latestMessagePreview = getLatestMessagePreview(channel, t, userLanguage);\n    return (React.createElement(Preview, { ...props, active: isActive, displayImage: displayImage, displayTitle: displayTitle, groupChannelDisplayInfo: groupChannelDisplayInfo, lastMessage: lastMessage, latestMessage: latestMessagePreview, latestMessagePreview: latestMessagePreview, messageDeliveryStatus: messageDeliveryStatus, setActiveChannel: setActiveChannel, unread: unread }));\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}